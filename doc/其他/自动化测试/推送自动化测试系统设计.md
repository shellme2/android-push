# 推送自动化测试分析系统

## 背景

+ 人工测试成本高，效率低，测试量有限
+ 推送受网络等环境因素影响大，人工测试场景有限

## 设计目标

+ 模拟人工测试方法，完成测试自动化、持续化
+ 保存测试记录、优化记录，完成开发——测试——预警——分析——优化闭环

## 测试场景

+ 特殊场景
	+ 开关机
	+ 网络断开重连
	+ 恢复出厂化设置

+ 正常场景
	+ 随机间隔时间测试

## 设计方案

+ 测试模式开关
	+ 需求：
		+ 使用推送消息控制：
	+ 方案：
		+ 判断push接收到的消息，如果消息内容为“EEBBK-PUSH-DEBUG-MODE-ON",“EEBBK-PUSH-DEBUG-MODE-OFF"
		+ 根据消息内容打开或者关闭Push进程的测试模式，更新状态值
		+ 通知到上层各个业务App进程，把App进程测试模式打开或者关闭。

+ 测试业务
	+ 需求1：
		+ 自动识别当前机器宿主APP，以及SDK信息
	+ 方案：
		+ 从Push进程跨进程获取
	+ 需求2：
		+ 自动更新Push当前连接状态（连接开始、连接中断、连接成功、连接失败）；
	+ 方案：
		+ Push进程在这些状态节点，发广播通知
	+ 需求3：
		+ 自动识别当前机器绑定推送的各个业务APP,UI显示列表，供测试时选择（单选、多选）
	+ 方案：
		+ 跨进程获取，Push进程提供接口
	+ 需求4：
		+ 配置测试消息内容到sd卡中，自动读取内容发送给对应的业务App。
	+ 方案：
		+ 读文件，Json格式
	+ 需求5：
		+ 定义推送过程关键节点字段、输出测试过程记录到SD卡

+ 分析业务
	+ 自动比对每条消息的发——收时间，计算推送成功率
	+ 自动分析消息延迟、无法接收原因

## 开发计划

+ 第一期：满足现有测试需求，完成自动推送消息，收发消息进行比对；

+ 第二期：针对性自动分析网络中断、消息延迟、无法接收等常规问题；

+ 第三期：测试和分析可视化开发；


## IM_Push后台接口

+ 测试URL:http://test.eebbk.net/im_push/api/push/sendMessage
+ 正式URL:http://push.eebbk.net/im_push/api/push/sendMessage
+ Req:
	+ aliases:别名（机器序列号）
	+ content：消息内容
	+ appName：应用名称
	+ offlineUnpush：1（离线），0（非离线）

## 技术实现

### 测试模式开关



### 状态识别

+ SDK信息、宿主APP、Push绑定的业务App等常规信息> 
+ Push连接状态(连接开始、连接中断、连接成功、连接失败)： > 
+ 

